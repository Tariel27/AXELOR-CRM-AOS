<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_7.1.xsd">
    <dashboard name="pbp.my-statistic-dashboard" title="Ratings by project!">
        <dashlet colSpan="3" rowSpan="7"  action="custom:pbp.self-user-statistics"/>
        <dashlet colSpan="3" rowSpan="7"  action="custom:pbp.self-user-awg-statistics"/>
        <dashlet colSpan="6"  rowSpan="7" action="custom:pbp.self-user-award-info"/>
    </dashboard>

    <custom name="pbp.self-user-award-info" title="Awards">
        <dataset type="rpc"><![CDATA[

          com.axelor.apps.pbproject.web.AwardsController:getAwardsOfUser

      ]]></dataset>
        <template><![CDATA[

      <>
          {data && data.length ? (
              <Table>
                  <thead>
                      <tr>
                          <th style={{ textAlign: "center" }}>Медаль</th>
                          <th style={{ textAlign: "left" }}>Благодарность</th>
                          <th style={{ textAlign: "left" }}>Способ получения</th>
                      </tr>
                  </thead>
                  <tbody>
                      {data.map((award, index) => (
                          <tr key={index}>
                              <td>
                                  {award.image ? (
                                      <img
                                          src={`${award.image}`}
                                          style={{ width: "120px", height: "120px", borderRadius: "50%" }}
                                      />
                                  ) : (
                                      <Box as="span">Нет изображения</Box>
                                  )}
                              </td>
                              <td>
                                  <Box as="span">{award.name || "Без названия"}</Box>
                              </td>
                              <td>
                                  <Box as="span">{award.descrip || "Описание отсутствует"}</Box>
                              </td>
                          </tr>
                      ))}
                  </tbody>
              </Table>
          ) : (
              <Box style={{ marginTop: "1rem" }}>Достижения не найдены.</Box>
          )}
      </>

      ]]></template>
    </custom>




    <custom name="pbp.self-user-statistics" title="Task Statistics" >
        <dataset type="rpc">
            <![CDATA[
            com.axelor.apps.pbproject.web.StatisticsController:getStatOfTasks
        ]]>
        </dataset>

        <template><![CDATA[
    <div class="report-data" style="
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background-color: #ffffff;
        margin-left: 64px;
        margin-bottom: 30px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        max-width: 320px;
        font-family: Arial, sans-serif;
        color: #333;">

        <h2 style="font-size: 24px; font-weight: bold; text-align: center; margin: 0 0 10px;">Всего задач</h2>
        <div style="font-size: 28px; font-weight: bold; text-align: center; color: #007bff; margin-bottom: 8px;">
            {{data.taskCount}}
        </div>

        <div class="task-status" style="
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            font-size: 16px;
            margin-bottom: 10px;">

            <p style="margin: 3px 0;"><strong>Новых:</strong> {{data.new}}</p>
            <p style="margin: 3px 0;"><strong>В процессе:</strong> {{data.inProgress}}</p>
            <p style="margin: 3px 0;"><strong>Завершённых:</strong> {{data.done}}</p>
            <p style="margin: 3px 0;"><strong>Отменённых:</strong> {{data.canceled}}</p>
        </div>

        <div style="
            padding-top: 10px;
            border-top: 1px solid #ccc;
            font-size: 16px;
            margin-top: 15px;
            text-align: center;">

            <h3 style="font-size: 18px; font-weight: bold; margin: 0;">Всего потрачено часов</h3>
            <p style="font-size: 20px; font-weight: bold; color: #28a745; margin: 5px 0 0;">
                {{data.totalWorkHours}}
            </p>
        </div>
    </div>
    ]]></template>
    </custom>

    <custom name="pbp.self-user-awg-statistics" title="Task Awg Statistics">
        <dataset type="rpc">
            <![CDATA[
        com.axelor.apps.pbproject.web.StatisticsController:getAwgStatistics
        ]]>
        </dataset>

        <template><![CDATA[
    <div class="report-data" style="
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        padding: 20px;
        background-color: #f9f9f9;
        margin: 20px auto;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        max-width: 340px;
        font-family: Arial, sans-serif;
        color: #333;">

        <!-- Заголовок общего количества задач -->
        <h2 style="font-size: 20px; font-weight: 600; color: #555; text-align: center; margin-bottom: 15px;">
            Всего задач за день
        </h2>
        <div style="font-size: 36px; font-weight: bold; text-align: center; color: #007bff; margin-bottom: 15px;">
            {{data.awgTaskInDay}} <!-- Среднее количество задач за день -->
        </div>

        <!-- Разделитель -->
        <hr style="border-top: 1px solid #ddd; margin: 20px 0;">

        <!-- Блок "Среднее время на одну задачу" -->
        <h3 style="font-size: 18px; font-weight: 600; color: #555; text-align: center; margin-bottom: 8px;">
            Среднее время на одну задачу
        </h3>
        <p style="font-size: 28px; font-weight: bold; color: #28a745; text-align: center; margin: 5px 0;">
            {{data.awgHoursForOneTask}} <!-- Среднее количество часов на одну задачу -->
        </p>

    </div>
    ]]></template>
    </custom>


</object-views>